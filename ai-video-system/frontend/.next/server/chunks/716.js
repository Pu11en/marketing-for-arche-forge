exports.id=716,exports.ids=[716],exports.modules={723:(e,t,r)=>{"use strict";r.a(e,async(e,o)=>{try{r.d(t,{Ho:()=>h,aC:()=>p});var s=r(997),a=r(6689),l=r(6677),n=r(6201),c=r(648),i=e([n,c]);[n,c]=i.then?(await i)():i;let u={user:null,isLoading:!1,isAuthenticated:!1,error:null},d=(e,t)=>{switch(t.type){case"AUTH_START":return{...e,isLoading:!0,error:null};case"AUTH_SUCCESS":return{...e,user:t.payload,isLoading:!1,isAuthenticated:!0,error:null};case"AUTH_FAILURE":return{...e,user:null,isLoading:!1,isAuthenticated:!1,error:t.payload};case"LOGOUT":return{...e,user:null,isLoading:!1,isAuthenticated:!1,error:null};case"CLEAR_ERROR":return{...e,error:null};case"UPDATE_USER":return{...e,user:e.user?{...e.user,...t.payload}:null};default:return e}},g=(0,a.createContext)(void 0),h=({children:e})=>{let[t,r]=(0,a.useReducer)(d,u),o=(0,l.useRouter)();(0,a.useEffect)(()=>{let e=localStorage.getItem("token"),t=localStorage.getItem("user");if(e&&t)try{let e=JSON.parse(t);r({type:"AUTH_SUCCESS",payload:e})}catch(e){console.error("Failed to parse user from localStorage:",e),localStorage.removeItem("token"),localStorage.removeItem("user")}},[]);let i=async e=>{try{r({type:"AUTH_START"});let t=await c.kv.login(e),{user:s,token:a}=t.data;localStorage.setItem("token",a),localStorage.setItem("user",JSON.stringify(s)),r({type:"AUTH_SUCCESS",payload:s}),n.default.success("Welcome back!"),"free"===s.subscriptionTier?o.push("/dashboard"):o.push("/studio")}catch(t){let e=t.response?.data?.message||"Login failed";throw r({type:"AUTH_FAILURE",payload:e}),n.default.error(e),t}},h=async e=>{try{r({type:"AUTH_START"});let t=await c.kv.register(e),{user:s,token:a}=t.data;localStorage.setItem("token",a),localStorage.setItem("user",JSON.stringify(s)),r({type:"AUTH_SUCCESS",payload:s}),n.default.success("Account created successfully!"),o.push("/onboarding")}catch(t){let e=t.response?.data?.message||"Registration failed";throw r({type:"AUTH_FAILURE",payload:e}),n.default.error(e),t}},p=async()=>{try{await c.kv.logout()}catch(e){console.error("Logout API call failed:",e)}finally{localStorage.removeItem("token"),localStorage.removeItem("user"),r({type:"LOGOUT"}),n.default.success("Logged out successfully"),o.push("/")}},y=async()=>{try{let e=await c.kv.refreshToken(),{user:t,token:o}=e.data;localStorage.setItem("token",o),localStorage.setItem("user",JSON.stringify(t)),r({type:"AUTH_SUCCESS",payload:t})}catch(e){console.error("Token refresh failed:",e),p()}},m={...t,login:i,register:h,logout:p,refreshToken:y,clearError:()=>{r({type:"CLEAR_ERROR"})}};return s.jsx(g.Provider,{value:m,children:e})},p=()=>{let e=(0,a.useContext)(g);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e};o()}catch(e){o(e)}})},863:(e,t,r)=>{"use strict";r.a(e,async(e,o)=>{try{r.d(t,{wP:()=>d});var s=r(997),a=r(6689),l=r(4612),n=r(723),c=r(6201),i=e([l,n,c]);[l,n,c]=i.then?(await i)():i;let u=(0,a.createContext)(void 0),d=({children:e})=>{let{user:t,isAuthenticated:r}=(0,n.aC)(),[o,c]=(0,a.useState)(null),[i,d]=(0,a.useState)(!1),[g,h]=(0,a.useState)(null);return(0,a.useEffect)(()=>{if(!r||!t){o&&(o.disconnect(),c(null),d(!1));return}let e=process.env.NEXT_PUBLIC_WS_URL||"http://localhost:3001",s=(0,l.io)(e,{auth:{userId:t.id,token:localStorage.getItem("token")},transports:["websocket","polling"],timeout:2e4});return s.on("connect",()=>{console.log("Socket connected"),d(!0),h(null)}),s.on("disconnect",e=>{console.log("Socket disconnected:",e),d(!1),"io server disconnect"===e&&s.disconnect()}),s.on("connect_error",e=>{console.error("Socket connection error:",e),h(e.message),d(!1)}),s.emit("join_user_room",{userId:t.id}),c(s),()=>{s.disconnect()}},[r,t]),s.jsx(u.Provider,{value:{socket:o,isConnected:i,error:g},children:e})};o()}catch(e){o(e)}})},4891:(e,t,r)=>{"use strict";r.d(t,{Fg:()=>n,f6:()=>l});var o=r(997),s=r(6689);let a=(0,s.createContext)(void 0),l=({children:e})=>{let[t,r]=(0,s.useState)(()=>"system"),[l,n]=(0,s.useState)("light");(0,s.useEffect)(()=>{let e=()=>{if("system"===t){let e=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";return n(e),e}return n(t),t};if(e(),"system"===t){let t=window.matchMedia("(prefers-color-scheme: dark)"),r=()=>e();return t.addEventListener("change",r),()=>t.removeEventListener("change",r)}return()=>{}},[t]),(0,s.useEffect)(()=>{let e=document.documentElement;e.classList.remove("light","dark"),e.classList.add(l),e.style.setProperty("--color-primary","59 130 246"),e.style.setProperty("--color-secondary","100 116 139"),e.style.setProperty("--color-success","34 197 94"),e.style.setProperty("--color-warning","245 158 11"),e.style.setProperty("--color-error","239 68 68"),e.style.setProperty("--color-accent","217 70 239")},[l]);let c=e=>{r(e),localStorage.setItem("theme",e)};return o.jsx(a.Provider,{value:{theme:t,setTheme:c,resolvedTheme:l,toggleTheme:()=>{"light"===t?c("dark"):"dark"===t?c("light"):c("light"===l?"dark":"light")}},children:e})},n=()=>{let e=(0,s.useContext)(a);if(void 0===e)throw Error("useTheme must be used within a ThemeProvider");return e}},2716:(e,t,r)=>{"use strict";r.a(e,async(e,o)=>{try{r.r(t),r.d(t,{default:()=>g});var s=r(997),a=r(1175),l=r(6201),n=r(6689),c=r(723),i=r(4891),u=r(863);r(2563);var d=e([l,c,u]);[l,c,u]=d.then?(await d)():d;let g=function({Component:e,pageProps:t}){let[r]=(0,n.useState)(()=>new a.QueryClient({defaultOptions:{queries:{staleTime:6e4,retry:1,refetchOnWindowFocus:!1}}}));return s.jsx(a.QueryClientProvider,{client:r,children:s.jsx(i.f6,{children:s.jsx(c.Ho,{children:(0,s.jsxs)(u.wP,{children:[s.jsx(e,{...t}),s.jsx(l.Toaster,{position:"top-right",toastOptions:{duration:4e3,style:{background:"rgb(var(--bg-secondary))",color:"rgb(var(--text-primary))",border:"1px solid rgb(var(--border-primary))",borderRadius:"var(--radius-lg)",padding:"12px 16px",fontSize:"14px",fontWeight:"500"},success:{iconTheme:{primary:"rgb(var(--color-success))",secondary:"rgb(var(--bg-secondary))"}},error:{iconTheme:{primary:"rgb(var(--color-error))",secondary:"rgb(var(--bg-secondary))"}}}})]})})})})};o()}catch(e){o(e)}})},648:(e,t,r)=>{"use strict";r.a(e,async(e,o)=>{try{r.d(t,{kv:()=>i});var s=r(9648),a=r(6201),l=e([s,a]);[s,a]=l.then?(await l)():l;let n=(()=>{let e=process.env.NEXT_PUBLIC_API_URL||"http://localhost:3001",t=s.default.create({baseURL:e,timeout:3e4,headers:{"Content-Type":"application/json"}});return t.interceptors.request.use(e=>{let t=localStorage.getItem("token");return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e)),t.interceptors.response.use(e=>e,async r=>{let o=r.config;if(r.response?.status===401&&!o._retry){o._retry=!0;try{let r=await s.default.post(`${e}/api/auth/refresh`,{},{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),{token:a}=r.data.data;return localStorage.setItem("token",a),o.headers.Authorization=`Bearer ${a}`,t(o)}catch(e){return localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/",Promise.reject(e)}}let l=r.response?.data?.message||r.message||"An error occurred";return r.response?.status>=500?a.default.error("Server error. Please try again later."):r.response?.status===429?a.default.error("Too many requests. Please try again later."):r.response?.status!==401&&a.default.error(l),Promise.reject(r)}),t})(),c={get:(e,t)=>n.get(e,t),post:(e,t,r)=>n.post(e,t,r),put:(e,t,r)=>n.put(e,t,r),patch:(e,t,r)=>n.patch(e,t,r),delete:(e,t)=>n.delete(e,t)},i={login:e=>c.post("/auth/login",e),register:e=>c.post("/auth/register",e),logout:()=>c.post("/auth/logout"),refreshToken:()=>c.post("/auth/refresh"),verifyEmail:e=>c.post("/auth/verify-email",{token:e}),forgotPassword:e=>c.post("/auth/forgot-password",{email:e}),resetPassword:(e,t)=>c.post("/auth/reset-password",{token:e,password:t})};o()}catch(e){o(e)}})},2563:()=>{}};